# –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π —è–¥—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞: –≤–∞–∫–∞–Ω—Å–∏–∏

## üéØ –¶–µ–ª—å
–£–ª—É—á—à–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å —è–¥—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ —Ä–µ–≤—å—é.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–Ω–∞
- –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏: –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –ö–æ–º–º–∏—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏

---

## üî¥ –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### –ó–∞–¥–∞—á–∞ 1: –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `@Transactional` –≤ `saveVacanciesInBatches()` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å `@Transactional(rollbackFor = Exception::class)` –≤ `VacancyFetchService.saveVacanciesInBatches()`
2. –î–æ–±–∞–≤–∏—Ç—å `@Transactional` –≤ `VacancyService.fetchVacanciesForConfig()` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–π –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyFetchService.kt`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–∞–∫–∞–Ω—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

### –ó–∞–¥–∞—á–∞ 2: –î–æ–±–∞–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–∞ vacancy_id
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π changelog —Ñ–∞–π–ª `007-add-unique-index-vacancy-id.yaml`
2. –î–æ–±–∞–≤–∏—Ç—å `UNIQUE INDEX` –Ω–∞ `vacancy_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `vacancies`
3. –û–±–Ω–æ–≤–∏—Ç—å `VacancyFetchService` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ `DataIntegrityViolationException` –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–∞—Ö
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ON CONFLICT DO NOTHING` –ª–æ–≥–∏–∫—É –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/resources/db/changelog/v1.0/007-add-unique-index-vacancy-id.yaml`
- `src/main/resources/db/changelog/db.changelog-master.yaml`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyFetchService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î: `./gradlew flywayMigrate` (–∏–ª–∏ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

---

### –ó–∞–¥–∞—á–∞ 3: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ published_at
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π changelog —Ñ–∞–π–ª `008-add-index-published-at.yaml`
2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å `idx_vacancies_published_at` –Ω–∞ –ø–æ–ª–µ `published_at`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/resources/db/changelog/v1.0/008-add-index-published-at.yaml`
- `src/main/resources/db/changelog/db.changelog-master.yaml`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ —Å `ORDER BY published_at`

---

### –ó–∞–¥–∞—á–∞ 4: –ù–µ —É–¥–∞–ª—è—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –∞ –ø–æ–º–µ—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å–æ–º
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–π —Å –±–∞–Ω-—Å–ª–æ–≤–∞–º–∏.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å `REJECTED_BY_VALIDATOR` –≤ `VacancyStatus`
2. –û–±–Ω–æ–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
3. –ò–∑–º–µ–Ω–∏—Ç—å `VacancyAnalysisService.analyzeVacancy()` - –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–º–µ—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å–æ–º
4. –£–¥–∞–ª–∏—Ç—å –≤—ã–∑–æ–≤ `skillExtractionService.deleteVacancyAndSkills()`
5. –û–±–Ω–æ–≤–∏—Ç—å `VacancyContentValidator` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/domain/entity/Vacancy.kt`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyAnalysisService.kt`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyContentValidator.kt`
- `src/main/resources/db/changelog/v1.0/009-add-rejected-status.yaml`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–∞–∫–∞–Ω—Å–∏–∏ —Å –±–∞–Ω-—Å–ª–æ–≤–∞–º–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è —Å—Ç–∞—Ç—É—Å–æ–º, –∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å `REJECTED_BY_VALIDATOR` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

---

## üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### –ó–∞–¥–∞—á–∞ 5: –î–æ–±–∞–≤–∏—Ç—å retry –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤–∞–∫–∞–Ω—Å–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö —Å–±–æ—è—Ö –≤–∞–∫–∞–Ω—Å–∏–∏ —Ç–µ—Ä—è—é—Ç—Å—è.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º –≤ `HHVacancyClient.fetchVacanciesPage()`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Retry` –∏–∑ Resilience4j –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (ConnectionException)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É
4. –ù–µ —Ä–µ—Ç—Ä–∞–∏—Ç—å –¥–ª—è 404, 401, 403 (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/client/hh/HHVacancyClient.kt`
- `src/main/kotlin/com/hhassistant/config/ResilienceConfig.kt` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Ä–µ—Ç—Ä–∞—è—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –Ω–µ —Ä–µ—Ç—Ä–∞—è—Ç—Å—è

---

### –ó–∞–¥–∞—á–∞ 6: –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ URL-–ø—Ä–æ–≤–µ—Ä–æ–∫
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ URL –∑–∞–º–µ–¥–ª—è—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ò–∑–º–µ–Ω–∏—Ç—å `VacancyAnalysisService` –¥–ª—è –±–∞—Ç—á–µ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ URL
2. –°–æ–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∫–∞–Ω—Å–∏–π –≤ –±–∞—Ç—á (5-10)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ Semaphore
4. –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞—Ç—á–∞–º–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyAnalysisService.kt`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyProcessingQueueService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ URL –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –ó–∞–¥–∞—á–∞ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω, –Ω–æ –Ω–∞–≤—ã–∫–∏ –º–æ–≥—É—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –û–±–µ—Ä–Ω—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –∏ –Ω–∞–≤—ã–∫–æ–≤ –≤ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Transactional` –≤ –º–µ—Ç–æ–¥–µ `analyzeVacancy()` –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–≤—ã–∫–æ–≤ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyAnalysisService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–≤—ã–∫–æ–≤ –∞–Ω–∞–ª–∏–∑ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑, –∏ –Ω–∞–≤—ã–∫–∏

---

### –ó–∞–¥–∞—á–∞ 8: –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥—Å—Ç—Ä–æ–∫ –≤ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–µ
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Java" –≤ "JavaScript").

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ò–∑–º–µ–Ω–∏—Ç—å `VacancyContentValidator.validateExclusionRules()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è word boundaries
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å `\b` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyContentValidator.kt`
- `src/test/kotlin/com/hhassistant/service/vacancy/VacancyContentValidatorTest.kt` (—Å–æ–∑–¥–∞—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ "Java" –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤ "JavaScript"
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üü¢ –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### –ó–∞–¥–∞—á–∞ 9: –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ url –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ URL.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å changelog —Ñ–∞–π–ª `010-add-index-url.yaml`
2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –Ω–∞ –ø–æ–ª–µ `url` (–º–æ–∂–Ω–æ hash index –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö URL)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/resources/db/changelog/v1.0/010-add-index-url.yaml`
- `src/main/resources/db/changelog/db.changelog-master.yaml`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ URL

---

### –ó–∞–¥–∞—á–∞ 10: –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å—Ç–∞—Ç—É—Å—É + –¥–∞—Ç–µ.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å changelog —Ñ–∞–π–ª `011-add-composite-index-status-fetched-at.yaml`
2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å `(status, fetched_at)` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å `(status, published_at)` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/resources/db/changelog/v1.0/011-add-composite-index-status-fetched-at.yaml`
- `src/main/resources/db/changelog/db.changelog-master.yaml`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ —Å WHERE status = ? AND fetched_at > ?

---

### –ó–∞–¥–∞—á–∞ 11: –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π (optimistic locking)
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω—ã lost updates –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `version` –≤ entity `Vacancy`
2. –î–æ–±–∞–≤–∏—Ç—å `@Version` –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é
3. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `version`
4. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ `OptimisticLockingException`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/domain/entity/Vacancy.kt`
- `src/main/resources/db/changelog/v1.0/012-add-version-field.yaml`
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyStatusService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –ó–∞–¥–∞—á–∞ 12: –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –ë–î –≤–º–µ—Å—Ç–æ –ø–∞–º—è—Ç–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `search_config_progress` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
2. –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –ë–î
3. –ó–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –û–±–Ω–æ–≤–∏—Ç—å `HHVacancyClient` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î –≤–º–µ—Å—Ç–æ –ø–∞–º—è—Ç–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/resources/db/changelog/v1.0/013-create-search-config-progress-table.yaml`
- `src/main/kotlin/com/hhassistant/domain/entity/SearchConfigProgress.kt` (—Å–æ–∑–¥–∞—Ç—å)
- `src/main/kotlin/com/hhassistant/repository/SearchConfigProgressRepository.kt` (—Å–æ–∑–¥–∞—Ç—å)
- `src/main/kotlin/com/hhassistant/client/hh/HHVacancyClient.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

---

### –ó–∞–¥–∞—á–∞ 13: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ `VacancyContentValidator`:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π
   - –ü—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (exclusion keywords, no skills)
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å `MetricsService`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyContentValidator.kt`
- `src/main/kotlin/com/hhassistant/metrics/MetricsService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ Prometheus/Grafana

---

### –ó–∞–¥–∞—á–∞ 14: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–µ–∑—é–º–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ –Ω–∞ –∫–∞–∂–¥—É—é –≤–∞–∫–∞–Ω—Å–∏—é –∑–∞–º–µ–¥–ª—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–∑—é–º–µ –≤ `VacancyContentValidator`
2. –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–µ–∑—é–º–µ
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Caffeine cache –∏–ª–∏ Spring Cache

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/main/kotlin/com/hhassistant/service/vacancy/VacancyContentValidator.kt`
- `src/main/kotlin/com/hhassistant/service/resume/ResumeService.kt`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã: `./gradlew test`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç–∞–ª–∞ –±—ã—Å—Ç—Ä–µ–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–µ–∑—é–º–µ

---

## üìù –ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏:

1. **–°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ):
   ```bash
   git checkout -b feature/vacancy-core-improvements-task-N
   ```

2. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è** —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É –∑–∞–¥–∞—á–∏

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã**:
   ```bash
   ./gradlew test
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä**:
   ```bash
   ./gradlew ktlintCheck
   ```

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É**:
   ```bash
   ./gradlew build
   ```

6. **–°–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç**:
   ```bash
   git add -A
   git commit -m "feat: [Task N] –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   ```

7. **–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ**

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

- –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã—Å–æ–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (ktlint)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

- [ ] –ó–∞–¥–∞—á–∞ 1: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- [ ] –ó–∞–¥–∞—á–∞ 2: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–∞ vacancy_id
- [ ] –ó–∞–¥–∞—á–∞ 3: –ò–Ω–¥–µ–∫—Å –Ω–∞ published_at
- [ ] –ó–∞–¥–∞—á–∞ 4: –°—Ç–∞—Ç—É—Å –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è
- [ ] –ó–∞–¥–∞—á–∞ 5: Retry –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- [ ] –ó–∞–¥–∞—á–∞ 6: –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ URL
- [ ] –ó–∞–¥–∞—á–∞ 7: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–ª—è –Ω–∞–≤—ã–∫–æ–≤
- [ ] –ó–∞–¥–∞—á–∞ 8: –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫
- [ ] –ó–∞–¥–∞—á–∞ 9: –ò–Ω–¥–µ–∫—Å –Ω–∞ url
- [ ] –ó–∞–¥–∞—á–∞ 10: –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å
- [ ] –ó–∞–¥–∞—á–∞ 11: –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ó–∞–¥–∞—á–∞ 12: –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –ë–î
- [ ] –ó–∞–¥–∞—á–∞ 13: –ú–µ—Ç—Ä–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [ ] –ó–∞–¥–∞—á–∞ 14: –ö—ç—à —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–∑—é–º–µ

